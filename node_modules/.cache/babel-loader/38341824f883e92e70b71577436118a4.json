{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/admin-pc/Desktop/vEngage/SHUBHAM/opterInterface_10th_jan_2021/shubham_operator_interface2021/src/workdesk/Workdesk.js\";\nimport React, { Component } from \"react\";\nimport { withAuth0 } from \"@auth0/auth0-react\"; // import Audio from \"../Audio/AudioFile/Audio\";\n\nimport OrderDetails from \"../OrderDetails/Forms/OrderDetails\";\nimport LoaderThreeDot from \"../Loader/LoaderThreeDot\";\nimport NewCallRecord from \"./showCallRecord/NewCallRecord\";\nimport UnconcludedCall from \"./showCallRecord/UnconcludedCall\";\nimport Conversation from \"./ShowConversation/Conversation\";\n\nclass Workdesk extends Component {\n  constructor() {\n    super();\n\n    this.componentDidMountWithToken = async () => {\n      const token = await this.GetAuthToken();\n      const ws = new WebSocket(`${this.state.endpoint}/oi/api/v1/ws/${token}`);\n\n      ws.onopen = () => {\n        //send any msg from Client if needed\n        console.log(\"connected\");\n      }; //save whatever response from client\n\n\n      ws.onmessage = evt => {\n        var str = evt.data;\n        console.log(\"messages--->\", str);\n        let jsonMsg = JSON.parse(str); // console.log(\"MESSAGETYPE\", jsonMsg.event_type);\n\n        if (jsonMsg.event_type === \"NEW_CALL\") {\n          let updatedData = this.state.new_calls;\n          updatedData.unshift(JSON.parse(evt.data)); // Adding new call in the beginning of updateData Array\n\n          console.log(\"updatedDATA: \" + updatedData);\n          this.setState({ ...this.state,\n            new_calls: updatedData // message:this.state.message.concat(JSON.parse(evt.data))\n\n          });\n        } else if (jsonMsg.event_type === \"CONVERSATION_DETAILS\") {\n          //  console.log(jsonMsg.details);\n          // var newcallObj = JSON.parse(evt.data);\n          // var displayed_conversionid = document.getElementById(\n          //   \"conversionid_textbox\"\n          // ).value;\n          let displayed_conversionid = this.state.conversationID;\n\n          if (displayed_conversionid == jsonMsg.conversation_id) {\n            this.DislpayLiveConvesationMessage(jsonMsg.details);\n          }\n        } else if (jsonMsg.event_type === \"ORDER_DETAILS\") {\n          console.log(\"JSONMSG_ORDER_DETAIL\", jsonMsg);\n          this.setState({ ...this.state,\n            fetchedOrder: jsonMsg\n          });\n        }\n      };\n\n      ws.onclose = evt => {\n        console.log(\"Disconnected\");\n        this.componentDidMountWithToken();\n      };\n    };\n\n    this.getConvdata = async (convid, centernm, callerid) => {\n      const token = await this.GetAuthToken();\n      document.getElementById(\"convdiv\").innerHTML = \"<img  id='convloader' width='550px' height='420px' src='/assets/images/messenger-icon.gif' />\"; // do stuff\n\n      fetch(process.env.REACT_APP_API_URL + \"/oi/api/v1/conversation/\" + convid, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).then(response => response.json()).then(data => {\n        return this.DisplayConvData(data, centernm, callerid, convid);\n      }).catch(err => {\n        this.noConvData();\n      });\n    };\n\n    this.GetAuthToken = async () => {\n      const {\n        getAccessTokenSilently\n      } = this.props.auth0;\n      const token = await getAccessTokenSilently();\n      return token;\n    };\n\n    this.MountComponentWithToken = async () => {\n      const {\n        getAccessTokenSilently\n      } = this.props.auth0;\n      const token = await this.GetAuthToken();\n      this.setState({ ...this.state,\n        Loading: true\n      }); //console.log(token);\n\n      fetch(process.env.REACT_APP_API_URL + \"/oi/api/v1/unconcluded-calls\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n          \"Content-type\": \"application/json\"\n        }\n      })\n      /*end fetch */\n      .then(results => results.json()).then(data => this.setState({ ...this.state,\n        unconcluded_calls: data,\n        Loading: false\n      }));\n    };\n\n    this.scrollToBottom = () => {\n      if (this.container) {\n        this.container.scrollTop = this.container.scrollHeight;\n      }\n    };\n\n    this.passShowRecordsStatus = (color, conversationID) => {\n      return color ? true : false;\n    };\n\n    this.state = {\n      unconcluded_calls: [],\n      new_calls: [],\n      Loading: false,\n      endpoint: process.env.REACT_APP_WS_URL,\n      message: [],\n      convmsg: [],\n      conversationID: \"\",\n      fetchedOrder: {},\n      showAudio: false,\n      NotShowLiveAudio: false,\n      OngoingCallClick: false,\n      OngoingCallSave: false\n    };\n  }\n\n  componentDidMount() {\n    //initialize connection\n    this.componentDidMountWithToken(); //this function runs when component mount initially\n  }\n\n  DisplayConvData(chatdetail_data, centernm, callerid, convid) {\n    var x = \"<ul class='chat' style='width:100%'>\";\n\n    for (let i in chatdetail_data) {\n      var utterance = JSON.stringify(chatdetail_data[i].utterance).replace('\"', \"\").replace('\"', \"\");\n      var message_from = JSON.stringify(chatdetail_data[i].utterance_from);\n      var receiptdate = JSON.stringify(chatdetail_data[i].creation_date).replace('\"', \"\").replace('\"', \"\");\n      var msgdtm = new Date(receiptdate);\n      var options = {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n        hour: \"numeric\",\n        minute: \"numeric\",\n        second: \"numeric\"\n      };\n      var twelevehour_msgdtm = msgdtm.toLocaleString(\"en-US\", options);\n      var asr_corrected_text = JSON.stringify(chatdetail_data[i].asr_corrected_text).replace('\"', \"\").replace('\"', \"\"); // Get the size of an object\n\n      Object.size = function (obj) {\n        var size = 0,\n            key;\n\n        for (key in obj) {\n          if (obj.hasOwnProperty(key)) size++;\n        }\n\n        return size;\n      };\n\n      let nlu_intent = JSON.parse(chatdetail_data[i].nlu_data);\n      nlu_intent = Object.size(nlu_intent) !== 0 ? Object.keys(nlu_intent)[0] : \"\";\n\n      if (message_from == '\"BOT\"') {\n        if (asr_corrected_text != \"null\") {\n          x += '<li style=\"margin-bottom:0px;padding-left:15px;width:80%\" class=\"agent clearfix\" ><span class=\"chat-img left clearfix \"><img src=\"http://placehold.it/50/55C1E7/fff&text=A I\" alt=\"AI\" class=\"img-circle\"/></span><div class=\" clearfix gradient-blue  bot-body\">' + utterance + '</p><span class=\"glyphicon glyphicon-time span-text\">' + asr_corrected_text + \"</span><div></div>\" + '<span class=\" clearfix\"><small class=\"right text-muted\"><span class=\"glyphicon glyphicon-time\"></span>' + twelevehour_msgdtm + \"</small></span></div><p>\" + \"</li>\";\n        } else {\n          x += '<li style=\"margin-bottom:0px;padding-left:15px;width:80%\" class=\"agent clearfix\"><span class=\"chat-img left clearfix \"><img src=\"http://placehold.it/50/55C1E7/fff&text=A I\" alt=\"AI\" class=\"img-circle\"/></span><div class=\" clearfix gradient-blue  bot-body\">' + utterance + \"</p>\" + '<span class=\" clearfix\"><small class=\"left text-muted\"><span class=\"glyphicon glyphicon-time\">' + twelevehour_msgdtm + \"</span>\" + \"</small></span></div>\" + \"</li>\";\n        }\n      } else {\n        if (asr_corrected_text != \"null\") {\n          x += '<li class=\"admin clearfix\" style=\"width:80%\"><span class=\"chat-img right clearfix\"><img src=\"http://placehold.it/50/FA6F57/fff&text=U\" alt=\"U\" class=\"img-circle\"/></span><div class=\" clearfix bot-body2\">' + utterance + '</p><span class=\"glyphicon glyphicon-time spanuser-text\">' + asr_corrected_text + \"</span>\" + '<span class=\" clearfix\"><small class=\"left dt-text\"><span class=\"glyphicon glyphicon-time\"></span>' + twelevehour_msgdtm + \"&nbsp;&nbsp;</small></span></div><p>\" + \"<p id='intent_id'>\" + \"{ intent: '\" + nlu_intent + \"' }\" + \"</p>\" + \"</li>\";\n        } else {\n          x += '<li class=\"admin clearfix\" style=\"width:80%\"><span class=\"chat-img right clearfix\"><img src=\"http://placehold.it/50/FA6F57/fff&text=U\" alt=\"U\" class=\"img-circle\"/></span><div class=\" clearfix bot-body2\">' + utterance + \"</span>\" + '<span class=\" clearfix\"><small class=\"left dt-text\"><span class=\"glyphicon glyphicon-time\"></span>' + twelevehour_msgdtm + \"&nbsp;&nbsp;</small></span></div><p>\" + \"<p id='intent_id'>\" + \"{ intent: '\" + nlu_intent + \"' }\" + \"</p>\" + \"</li>\";\n        }\n      }\n    }\n\n    document.getElementById(\"convdiv\").innerHTML = x + \"</ul>\";\n    document.getElementById(\"callerid_chatdiv\").innerHTML = callerid; // updating conversation chatdiv line no. - 304 (sandeep)\n\n    document.getElementById(\"converseid_chatdiv\").innerHTML = convid;\n    document.getElementById(\"div_centernm\").innerHTML = centernm;\n    document.getElementById(\"conversionid_textbox\").value = convid;\n    this.setState({ ...this.state,\n      conversationID: convid,\n      showAudio: true\n    });\n  }\n\n  noConvData() {\n    var x = \"<ul class='chat'>\";\n    document.getElementById(\"convdiv\").innerHTML = x + \"No Convesation Data Found\" + \"</ul>\";\n  }\n\n  componentWillMount() {\n    this.MountComponentWithToken();\n  } //end life cycle\n\n\n  render() {\n    let OngoingCallPass = colorYes => {\n      this.setState({ ...this.state,\n        OngoingCallSave: colorYes,\n        OngoingCallClick: false\n      });\n    }; // let src = `${process.env.REACT_APP_API_URL}/oi/api/twilio/audio/${this.state.conversationID}`;\n    //alert(this.state.data)\n\n\n    let showcallRecords = null;\n\n    if (this.state.Loading) {\n      showcallRecords = /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"text-center\",\n        style: {\n          marginTop: \"45vh\"\n        },\n        children: /*#__PURE__*/_jsxDEV(LoaderThreeDot, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this);\n    } else {\n      showcallRecords = /*#__PURE__*/_jsxDEV(\"ul\", {\n        class: \"nav nav-pills nav-pills-warning nav-stacked flex-column\",\n        style: {\n          flex: 1,\n          scrollSnapType: \"y mandatory\"\n        },\n        role: \"tablist\",\n        children: [this.state.new_calls.map((k, index) => /*#__PURE__*/_jsxDEV(NewCallRecord, {\n          conversationID: k.conversation_id,\n          centerName: k.center_name,\n          callerId: k.caller_id,\n          initialTime: k.initiate_time,\n          getConvdata: (convId, centerName, callerId) => this.getConvdata(convId, centerName, callerId)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, this)), this.state.unconcluded_calls.map((k, index) => /*#__PURE__*/_jsxDEV(UnconcludedCall, {\n          conversationID: k.conversation_id,\n          centerName: k.center_name,\n          callerId: k.caller_id,\n          initialTime: k.initiate_time,\n          getConvdata: (convId, centerName, callerId) => this.getConvdata(convId, centerName, callerId)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 9\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"content-wrapper content-margin\",\n      style: {\n        margin: \"0px\",\n        padding: \"0px\",\n        boxSizing: \"border-box\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"container-fluid\" // style={{ backgroundColor: \"red\",}}\n        ,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"content-wrapper content-margin\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"container-fluid\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                id: \"callrec\" // class=\" call_divscrl\"\n                ,\n                class: \"col-md-2 call_divscrl\",\n                style: {\n                  height: \"90vh\",\n                  padding: \"0px\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: showcallRecords\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 352,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                // class=\"tab-content\"\n                // class=\"col-md-7 tab-content\"\n                style: {\n                  height: \"90vh\",\n                  // backgroundColor: \"yellow\",\n                  width: \"56.5vw\",\n                  marginRight: \"0px\"\n                },\n                children: /*#__PURE__*/_jsxDEV(Conversation, {\n                  showAudio: this.state.showAudio,\n                  conversationID: this.state.conversationID\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 365,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 355,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \" col-md-3\",\n                style: {\n                  height: \"90vh\",\n                  // backgroundColor: \"#DADCD4\",\n                  // width: \"25%\",\n                  marginLeft: \"0px\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"col-lg-12 col-md-12\",\n                  id: \"orderdetail_div\",\n                  children: /*#__PURE__*/_jsxDEV(OrderDetails, {\n                    OngoingCallPass: OngoingCallPass,\n                    recordsLoading: this.state.Loading,\n                    convid: this.state.conversationID,\n                    getTokenFunc: this.GetAuthToken,\n                    fetchedLiveOrder: this.state.fetchedOrder\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 383,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 382,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 373,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"hidden\",\n            name: \"conversionid_textbox\",\n            id: \"conversionid_textbox\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default _c = withAuth0(Workdesk);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/home/admin-pc/Desktop/vEngage/SHUBHAM/opterInterface_10th_jan_2021/shubham_operator_interface2021/src/workdesk/Workdesk.js"],"names":["React","Component","withAuth0","OrderDetails","LoaderThreeDot","NewCallRecord","UnconcludedCall","Conversation","Workdesk","constructor","componentDidMountWithToken","token","GetAuthToken","ws","WebSocket","state","endpoint","onopen","console","log","onmessage","evt","str","data","jsonMsg","JSON","parse","event_type","updatedData","new_calls","unshift","setState","displayed_conversionid","conversationID","conversation_id","DislpayLiveConvesationMessage","details","fetchedOrder","onclose","getConvdata","convid","centernm","callerid","document","getElementById","innerHTML","fetch","process","env","REACT_APP_API_URL","headers","Authorization","then","response","json","DisplayConvData","catch","err","noConvData","getAccessTokenSilently","props","auth0","MountComponentWithToken","Loading","method","Accept","results","unconcluded_calls","scrollToBottom","container","scrollTop","scrollHeight","passShowRecordsStatus","color","REACT_APP_WS_URL","message","convmsg","showAudio","NotShowLiveAudio","OngoingCallClick","OngoingCallSave","componentDidMount","chatdetail_data","x","i","utterance","stringify","replace","message_from","utterance_from","receiptdate","creation_date","msgdtm","Date","options","year","month","day","hour","minute","second","twelevehour_msgdtm","toLocaleString","asr_corrected_text","Object","size","obj","key","hasOwnProperty","nlu_intent","nlu_data","keys","value","componentWillMount","render","OngoingCallPass","colorYes","showcallRecords","marginTop","flex","scrollSnapType","map","k","index","center_name","caller_id","initiate_time","convId","centerName","callerId","margin","padding","boxSizing","height","width","marginRight","marginLeft"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withAuth0 } from \"@auth0/auth0-react\";\n// import Audio from \"../Audio/AudioFile/Audio\";\nimport OrderDetails from \"../OrderDetails/Forms/OrderDetails\";\nimport LoaderThreeDot from \"../Loader/LoaderThreeDot\";\nimport NewCallRecord from \"./showCallRecord/NewCallRecord\";\nimport UnconcludedCall from \"./showCallRecord/UnconcludedCall\";\nimport Conversation from \"./ShowConversation/Conversation\";\n\nclass Workdesk extends Component {\n  constructor() {\n    super();\n    this.state = {\n      unconcluded_calls: [],\n      new_calls: [],\n      Loading: false,\n      endpoint: process.env.REACT_APP_WS_URL,\n      message: [],\n      convmsg: [],\n      conversationID: \"\",\n      fetchedOrder: {},\n      showAudio: false,\n      NotShowLiveAudio: false,\n      OngoingCallClick: false,\n      OngoingCallSave: false,\n    };\n  }\n\n  componentDidMount() {\n    //initialize connection\n    this.componentDidMountWithToken(); //this function runs when component mount initially\n  }\n\n  componentDidMountWithToken = async () => {\n    const token = await this.GetAuthToken();\n    const ws = new WebSocket(`${this.state.endpoint}/oi/api/v1/ws/${token}`);\n    ws.onopen = () => {\n      //send any msg from Client if needed\n      console.log(\"connected\");\n    };\n    //save whatever response from client\n\n    ws.onmessage = (evt) => {\n      var str = evt.data;\n      console.log(\"messages--->\", str);\n      let jsonMsg = JSON.parse(str);\n      // console.log(\"MESSAGETYPE\", jsonMsg.event_type);\n      if (jsonMsg.event_type === \"NEW_CALL\") {\n        let updatedData = this.state.new_calls;\n        updatedData.unshift(JSON.parse(evt.data)); // Adding new call in the beginning of updateData Array\n\n        console.log(\"updatedDATA: \" + updatedData);\n        this.setState({\n          ...this.state,\n          new_calls: updatedData,\n          // message:this.state.message.concat(JSON.parse(evt.data))\n        });\n      } else if (jsonMsg.event_type === \"CONVERSATION_DETAILS\") {\n        //  console.log(jsonMsg.details);\n\n        // var newcallObj = JSON.parse(evt.data);\n        // var displayed_conversionid = document.getElementById(\n        //   \"conversionid_textbox\"\n        // ).value;\n        let displayed_conversionid = this.state.conversationID;\n        if (displayed_conversionid == jsonMsg.conversation_id) {\n          this.DislpayLiveConvesationMessage(jsonMsg.details);\n        }\n      } else if (jsonMsg.event_type === \"ORDER_DETAILS\") {\n        console.log(\"JSONMSG_ORDER_DETAIL\", jsonMsg);\n        this.setState({\n          ...this.state,\n          fetchedOrder: jsonMsg,\n        });\n      }\n    };\n\n    ws.onclose = (evt) => {\n      console.log(\"Disconnected\");\n      this.componentDidMountWithToken();\n    };\n  };\n\n \n\n \n\n  getConvdata = async (convid, centernm, callerid) => {\n    const token = await this.GetAuthToken();\n\n    document.getElementById(\"convdiv\").innerHTML =\n      \"<img  id='convloader' width='550px' height='420px' src='/assets/images/messenger-icon.gif' />\";\n    // do stuff\n\n    fetch(process.env.REACT_APP_API_URL + \"/oi/api/v1/conversation/\" + convid, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    })\n      .then((response) => response.json())\n      .then((data) => {\n        return this.DisplayConvData(data, centernm, callerid, convid);\n      })\n      .catch((err) => {\n        this.noConvData();\n      });\n  };\n\n  DisplayConvData(chatdetail_data, centernm, callerid, convid) {\n    var x = \"<ul class='chat' style='width:100%'>\";\n\n    for (let i in chatdetail_data) {\n      var utterance = JSON.stringify(chatdetail_data[i].utterance)\n        .replace('\"', \"\")\n        .replace('\"', \"\");\n      var message_from = JSON.stringify(chatdetail_data[i].utterance_from);\n      var receiptdate = JSON.stringify(chatdetail_data[i].creation_date)\n        .replace('\"', \"\")\n        .replace('\"', \"\");\n      var msgdtm = new Date(receiptdate);\n      var options = {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n        hour: \"numeric\",\n        minute: \"numeric\",\n        second: \"numeric\",\n      };\n      var twelevehour_msgdtm = msgdtm.toLocaleString(\"en-US\", options);\n      var asr_corrected_text = JSON.stringify(\n        chatdetail_data[i].asr_corrected_text\n      )\n        .replace('\"', \"\")\n        .replace('\"', \"\");\n      // Get the size of an object\n      Object.size = function (obj) {\n        var size = 0,\n          key;\n        for (key in obj) {\n          if (obj.hasOwnProperty(key)) size++;\n        }\n        return size;\n      };\n\n      let nlu_intent = JSON.parse(chatdetail_data[i].nlu_data);\n      nlu_intent =\n        Object.size(nlu_intent) !== 0 ? Object.keys(nlu_intent)[0] : \"\";\n\n      if (message_from == '\"BOT\"') {\n        if (asr_corrected_text != \"null\") {\n          x +=\n            '<li style=\"margin-bottom:0px;padding-left:15px;width:80%\" class=\"agent clearfix\" ><span class=\"chat-img left clearfix \"><img src=\"http://placehold.it/50/55C1E7/fff&text=A I\" alt=\"AI\" class=\"img-circle\"/></span><div class=\" clearfix gradient-blue  bot-body\">' +\n            utterance +\n            '</p><span class=\"glyphicon glyphicon-time span-text\">' +\n            asr_corrected_text +\n            \"</span><div></div>\" +\n            '<span class=\" clearfix\"><small class=\"right text-muted\"><span class=\"glyphicon glyphicon-time\"></span>' +\n            twelevehour_msgdtm +\n            \"</small></span></div><p>\" +\n            \"</li>\";\n        } else {\n          x +=\n            '<li style=\"margin-bottom:0px;padding-left:15px;width:80%\" class=\"agent clearfix\"><span class=\"chat-img left clearfix \"><img src=\"http://placehold.it/50/55C1E7/fff&text=A I\" alt=\"AI\" class=\"img-circle\"/></span><div class=\" clearfix gradient-blue  bot-body\">' +\n            utterance +\n            \"</p>\" +\n            '<span class=\" clearfix\"><small class=\"left text-muted\"><span class=\"glyphicon glyphicon-time\">' +\n            twelevehour_msgdtm +\n            \"</span>\" +\n            \"</small></span></div>\" +\n            \"</li>\";\n        }\n      } else {\n        if (asr_corrected_text != \"null\") {\n          x +=\n            '<li class=\"admin clearfix\" style=\"width:80%\"><span class=\"chat-img right clearfix\"><img src=\"http://placehold.it/50/FA6F57/fff&text=U\" alt=\"U\" class=\"img-circle\"/></span><div class=\" clearfix bot-body2\">' +\n            utterance +\n            '</p><span class=\"glyphicon glyphicon-time spanuser-text\">' +\n            asr_corrected_text +\n            \"</span>\" +\n            '<span class=\" clearfix\"><small class=\"left dt-text\"><span class=\"glyphicon glyphicon-time\"></span>' +\n            twelevehour_msgdtm +\n            \"&nbsp;&nbsp;</small></span></div><p>\" +\n            \"<p id='intent_id'>\" +\n            \"{ intent: '\" +\n            nlu_intent +\n            \"' }\" +\n            \"</p>\" +\n            \"</li>\";\n        } else {\n          x +=\n            '<li class=\"admin clearfix\" style=\"width:80%\"><span class=\"chat-img right clearfix\"><img src=\"http://placehold.it/50/FA6F57/fff&text=U\" alt=\"U\" class=\"img-circle\"/></span><div class=\" clearfix bot-body2\">' +\n            utterance +\n            \"</span>\" +\n            '<span class=\" clearfix\"><small class=\"left dt-text\"><span class=\"glyphicon glyphicon-time\"></span>' +\n            twelevehour_msgdtm +\n            \"&nbsp;&nbsp;</small></span></div><p>\" +\n            \"<p id='intent_id'>\" +\n            \"{ intent: '\" +\n            nlu_intent +\n            \"' }\" +\n            \"</p>\" +\n            \"</li>\";\n        }\n      }\n    }\n\n    document.getElementById(\"convdiv\").innerHTML = x + \"</ul>\";\n    document.getElementById(\"callerid_chatdiv\").innerHTML = callerid;\n\n    // updating conversation chatdiv line no. - 304 (sandeep)\n    document.getElementById(\"converseid_chatdiv\").innerHTML = convid;\n\n    document.getElementById(\"div_centernm\").innerHTML = centernm;\n\n    document.getElementById(\"conversionid_textbox\").value = convid;\n\n    this.setState({\n      ...this.state,\n      conversationID: convid,\n      showAudio: true,\n    });\n  }\n\n  noConvData() {\n    var x = \"<ul class='chat'>\";\n\n    document.getElementById(\"convdiv\").innerHTML =\n      x + \"No Convesation Data Found\" + \"</ul>\";\n  }\n\n  GetAuthToken = async () => {\n    const { getAccessTokenSilently } = this.props.auth0;\n    const token = await getAccessTokenSilently();\n    return token;\n  };\n\n  MountComponentWithToken = async () => {\n    const { getAccessTokenSilently } = this.props.auth0;\n    const token = await this.GetAuthToken();\n    this.setState({\n      ...this.state,\n      Loading: true,\n    });\n    //console.log(token);\n    fetch(process.env.REACT_APP_API_URL + \"/oi/api/v1/unconcluded-calls\", {\n      method: \"GET\",\n      headers: {\n        Authorization: `Bearer ${token}`,\n        Accept: \"application/json\",\n        \"Content-type\": \"application/json\",\n      },\n    }) /*end fetch */\n      .then((results) => results.json())\n      .then((data) =>\n        this.setState({\n          ...this.state,\n          unconcluded_calls: data,\n          Loading: false,\n        })\n      );\n  };\n\n  componentWillMount() {\n    this.MountComponentWithToken();\n  } //end life cycle\n\n  scrollToBottom = () => {\n    if (this.container) {\n      this.container.scrollTop = this.container.scrollHeight;\n    }\n  };\n  passShowRecordsStatus = (color, conversationID) => {\n    return color ? true : false;\n  };\n  render() {\n    let OngoingCallPass = (colorYes) => {\n      this.setState({\n        ...this.state,\n        OngoingCallSave: colorYes,\n        OngoingCallClick: false,\n      });\n    };\n\n    // let src = `${process.env.REACT_APP_API_URL}/oi/api/twilio/audio/${this.state.conversationID}`;\n    //alert(this.state.data)\n    let showcallRecords = null;\n    if (this.state.Loading) {\n      showcallRecords = (\n        <div\n          class=\"text-center\"\n          style={{\n            marginTop: \"45vh\",\n          }}\n        >\n          <LoaderThreeDot />\n        </div>\n      );\n    } else {\n      showcallRecords = (\n        <ul\n          class=\"nav nav-pills nav-pills-warning nav-stacked flex-column\"\n          style={{ flex: 1, scrollSnapType: \"y mandatory\" }}\n          role=\"tablist\"\n        >\n          {this.state.new_calls.map((k,index) => (\n            <NewCallRecord\n            key={index}\n            conversationID={k.conversation_id}\n            centerName={k.center_name}\n            callerId={k.caller_id}\n            initialTime={k.initiate_time}\n            getConvdata={(convId,centerName,callerId)=>this.getConvdata(convId,centerName,callerId)}\n            />\n            ))}\n\n          {this.state.unconcluded_calls.map((k,index) => (\n            <UnconcludedCall\n            key={index}\n              conversationID={k.conversation_id}\n              centerName={k.center_name}\n              callerId={k.caller_id}\n              initialTime={k.initiate_time}\n              getConvdata={(convId,centerName,callerId)=>this.getConvdata(convId,centerName,callerId)}\n              \n            />\n          ))}\n        </ul>\n      );\n    }\n\n    return (\n      <div\n        class=\"content-wrapper content-margin\"\n        style={{ margin: \"0px\", padding: \"0px\", boxSizing: \"border-box\" }}\n      >\n        <div\n          class=\"container-fluid\"\n          // style={{ backgroundColor: \"red\",}}\n        >\n          <div class=\"content-wrapper content-margin\">\n            <div class=\"container-fluid\">\n              <div class=\"row\">\n                <div\n                  id=\"callrec\"\n                  // class=\" call_divscrl\"\n                  class=\"col-md-2 call_divscrl\"\n                  style={{\n                    height: \"90vh\",\n                    padding: \"0px\",\n                  }}\n                >\n                  <div>{showcallRecords}</div>\n                </div>\n\n                <div\n                  // class=\"tab-content\"\n                  // class=\"col-md-7 tab-content\"\n                  style={{\n                    height: \"90vh\",\n                    // backgroundColor: \"yellow\",\n                    width: \"56.5vw\",\n                    marginRight: \"0px\",\n                  }}\n                >\n                  <Conversation\n                    showAudio={this.state.showAudio}\n                    conversationID={this.state.conversationID}\n                  />\n                </div>\n\n                {/* ORDER DETAILS  */}\n                {/*--Order Detail Start--*/}\n                <div\n                  class=\" col-md-3\"\n                  style={{\n                    height: \"90vh\",\n                    // backgroundColor: \"#DADCD4\",\n                    // width: \"25%\",\n                    marginLeft: \"0px\",\n                  }}\n                >\n                  <div class=\"col-lg-12 col-md-12\" id=\"orderdetail_div\">\n                    <OrderDetails\n                      OngoingCallPass={OngoingCallPass}\n                      recordsLoading={this.state.Loading}\n                      convid={this.state.conversationID}\n                      getTokenFunc={this.GetAuthToken}\n                      fetchedLiveOrder={this.state.fetchedOrder}\n                    />\n                    {/* <OrderDetailsNew\n                      convid={this.state.conversationID}\n                      getTokenFunc={this.GetAuthToken}\n                      fetchedLiveOrder={this.state.fetchedOrder}\n                    /> */}\n                  </div>\n                </div>\n                {/*Order Detail End*/}\n              </div>\n            </div>\n            <input\n              type=\"hidden\"\n              name=\"conversionid_textbox\"\n              id=\"conversionid_textbox\"\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withAuth0(Workdesk);\n"]},"metadata":{},"sourceType":"module"}